<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Compare Polygenic Scores (PGS) using bootstrapping — pgsmetrics • pgsmetrics</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compare Polygenic Scores (PGS) using bootstrapping — pgsmetrics"><meta name="description" content="This function compares Polygenic Scores (PGS) by bootstrapping the difference
between them using various metrics. It supports single PGS evaluation, pairwise
comparisons, and ranking of multiple PGS."><meta property="og:description" content="This function compares Polygenic Scores (PGS) by bootstrapping the difference
between them using various metrics. It supports single PGS evaluation, pairwise
comparisons, and ranking of multiple PGS."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pgsmetrics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.9</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/pgsmetrics.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Compare Polygenic Scores (PGS) using bootstrapping</h1>

      <div class="d-none name"><code>pgsmetrics.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function compares Polygenic Scores (PGS) by bootstrapping the difference
between them using various metrics. It supports single PGS evaluation, pairwise
comparisons, and ranking of multiple PGS.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pgsmetrics</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">pgs</span>,</span>
<span>  <span class="va">dep</span>,</span>
<span>  covars <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  K <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  boot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  boot_method <span class="op">=</span> <span class="st">"standard"</span>,</span>
<span>  blb_s <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  blb_r <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  blb_b <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  n_boot <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  n_cores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  missing <span class="op">=</span> <span class="st">"warn"</span>,</span>
<span>  return_boot_stats <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  custom_metrics_list <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data.table containing necessary data: PGS, dependent variable, and covariates.</p></dd>


<dt id="arg-pgs">pgs<a class="anchor" aria-label="anchor" href="#arg-pgs"></a></dt>
<dd><p>Character vector. Metrics are computed for these pgs. Must exist in <code>data</code>.</p></dd>


<dt id="arg-dep">dep<a class="anchor" aria-label="anchor" href="#arg-dep"></a></dt>
<dd><p>Character. Name of the dependent variable in <code>data</code>. Binary variable must be 0/1 (otherwise continuous assumed).</p></dd>


<dt id="arg-covars">covars<a class="anchor" aria-label="anchor" href="#arg-covars"></a></dt>
<dd><p>Character vector. Names of covariate to adjust for. Must be in columns in <code>data</code>.</p></dd>


<dt id="arg-k">K<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>Double, between 0 and 1. Prevalence of the binary trait in the population. Used by $R^2$ on the liability scale.</p></dd>


<dt id="arg-boot">boot<a class="anchor" aria-label="anchor" href="#arg-boot"></a></dt>
<dd><p>Boolean. Whether to perform bootstrap or not.</p></dd>


<dt id="arg-boot-method">boot_method<a class="anchor" aria-label="anchor" href="#arg-boot-method"></a></dt>
<dd><p>Character vector. Either <code>standard</code> or <code>blb</code>. <code>standard</code> is the usual non-parametric bootstrap, <code>blb</code> is the Bag of Little Bootstraps, useful for analysis on large datasets (f.x., $n&gt;500000$) with many PGS. However, BLB and the standard bootstrap may not yield identical results. The standard bootstrap uses the observed statistics (all observations) and gives percentile CIs with resampling. The BLB bootstrap estimates the mean across all resamples (instead of the observed value) and percentile CIs.</p></dd>


<dt id="arg-blb-s">blb_s<a class="anchor" aria-label="anchor" href="#arg-blb-s"></a></dt>
<dd><p>Integer. TODO. Default: 20.</p></dd>


<dt id="arg-blb-r">blb_r<a class="anchor" aria-label="anchor" href="#arg-blb-r"></a></dt>
<dd><p>Integer. TODO. Default: 100.</p></dd>


<dt id="arg-blb-b">blb_b<a class="anchor" aria-label="anchor" href="#arg-blb-b"></a></dt>
<dd><p>Double between 0 and 1. TODO. Default: 0.8.</p></dd>


<dt id="arg-n-boot">n_boot<a class="anchor" aria-label="anchor" href="#arg-n-boot"></a></dt>
<dd><p>Integer. Number of bootstrap iterations. Default is 1000.</p></dd>


<dt id="arg-n-cores">n_cores<a class="anchor" aria-label="anchor" href="#arg-n-cores"></a></dt>
<dd><p>Integer. Number of cores for parallel processing. Default is 1.</p></dd>


<dt id="arg-missing">missing<a class="anchor" aria-label="anchor" href="#arg-missing"></a></dt>
<dd><p>Warns if missing values in <code>data</code>. Use missing="drop" to drop rows with missing values. However, we recommend imputing missing values instead. Default: "warn".</p></dd>


<dt id="arg-return-boot-stats">return_boot_stats<a class="anchor" aria-label="anchor" href="#arg-return-boot-stats"></a></dt>
<dd><p>Return bootstrap output before processing (for debugging). Default: FALSE.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class "pgsmetrics" containing:</p>
<dl><dt>metrics</dt>
<dd><p>A data.table with calculated metrics for each PGS. In this data.table, <code>type</code> can be partial/full/cov, where partial=full-cov, full=model with covariates+pgs, cov=model with only covariates. When using <code>boot_method="blb"</code>, the <code>observed</code> column is the median value of the metric statistic, but when using <code>boot_method="standard"</code>, it is the value from an analysis on the unmodified dataset.</p></dd>

<dt>boot_output</dt>
<dd><p>The raw output from the bootstrapping process.</p></dd>

<dt>call</dt>
<dd><p>The original function call.</p></dd>

</dl></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Simulate data</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="simulate_data.html">simulate_data</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span>, n_pgs <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Single PGS evaluation</span></span></span>
<span class="r-in"><span><span class="va">result_single</span> <span class="op">&lt;-</span> <span class="fu">pgsmetrics</span><span class="op">(</span><span class="va">data</span>,</span></span>
<span class="r-in"><span>    pgs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pgs1"</span>, <span class="st">"pgs2"</span>, <span class="st">"pgs3"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    dep <span class="op">=</span> <span class="st">"y_bin"</span>,</span></span>
<span class="r-in"><span>    covars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age"</span>, <span class="st">"sex"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    n_boot <span class="op">=</span> <span class="fl">100</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Binary outcome variable detected</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> bootstrapping (standard)...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> processing resamples...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> computing observed values...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> computing differences...</span>
<span class="r-in"><span><span class="co"># print(result_single)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kristjan Norland.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

